<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Payment Successful - Reso</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        dark: '#111111',
                        // å®šä¹‰çˆ±é©¬ä»•è“ (Bleu Nuit é£æ ¼)
                        hermesBlue: '#0B2044', // æ·±é‚ƒåˆå¤œè“ï¼Œé«˜çº§æ„Ÿæ‹‰æ»¡
                        hermesOrange: '#F37021', // çˆ±é©¬ä»•æ©™ (ä»…ä½œå‚è€ƒ)
                    },
                    animation: {
                        'float': 'float 6s ease-in-out infinite',
                    },
                    keyframes: {
                        float: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-10px)' },
                        }
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-white flex items-center justify-center min-h-screen font-sans text-dark overflow-hidden">

    <div class="max-w-md w-full p-8 text-center relative z-10">
        
        <div class="animate-float">
            <img src="https://reso.dzgapp.com/Reso_Logo.png" 
                 alt="Reso App Icon" 
                 class="w-24 h-24 mx-auto mb-8 hover:scale-105 transition-transform duration-500 cursor-pointer">
        </div>

        <h1 class="text-3xl font-bold mb-3 tracking-tight text-gray-900">Payment Successful!</h1>
        <p class="text-gray-500 mb-10 text-lg font-medium">Thank you for supporting Reso.</p>

        <div id="activation-area" class="hidden opacity-0 transition-opacity duration-700 ease-out translate-y-4" style="animation: fadeUp 0.8s forwards;">
            
            <div class="mb-8 p-5 bg-gradient-to-br from-gray-50 to-white rounded-2xl border border-gray-200">
                <p class="text-xs font-bold text-gray-400 uppercase tracking-widest mb-4">Step 1: Download Reso</p>
                <a href="https://github.com/yg1112/reso-releases/releases/latest/download/Reso.dmg" 
                   class="group flex items-center justify-center gap-2 w-full bg-gray-900 hover:bg-black text-white font-bold text-base py-3.5 rounded-xl transition-all duration-300 shadow-lg hover:shadow-xl hover:-translate-y-0.5 mb-3">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10"></path></svg>
                    <span>Download Reso.dmg</span>
                </a>
                <p class="text-xs text-gray-400 font-medium">macOS 14+ â€¢ Apple Silicon</p>
            </div>

            <div class="mb-8 p-5 bg-white rounded-2xl border-2 border-hermesBlue/20">
                <p class="text-xs font-bold text-gray-400 uppercase tracking-widest mb-4">Step 2: Activate License</p>
                <a id="activate-btn" href="#" class="group block w-full bg-hermesBlue hover:bg-[#152a55] text-white font-bold text-base py-3.5 rounded-xl transition-all duration-300 transform hover:scale-[1.02] hover:shadow-xl shadow-lg shadow-blue-900/10 mb-3 flex items-center justify-center">
                    <span>Open Reso to Activate</span>
                    <svg class="w-5 h-5 ml-2 transform group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3"></path></svg>
                </a>
                <p class="text-xs text-gray-400 font-medium">
                    Click above after installing the app
                </p>
            </div>

            <div class="bg-gray-50 rounded-xl p-5 text-left group hover:bg-gray-100 transition-colors duration-300">
                <p class="text-[10px] font-bold text-gray-400 uppercase tracking-widest mb-2">Backup Activation Code</p>
                <div class="flex items-center justify-between">
                    <code id="manual-code" class="font-mono text-sm text-gray-800 break-all select-all font-semibold tracking-wide">Loading...</code>
                    <button onclick="copyCode()" class="ml-3 text-xs font-bold text-hermesBlue hover:text-blue-600 uppercase tracking-wider opacity-60 group-hover:opacity-100 transition-all">Copy</button>
                </div>
            </div>
        </div>

        <div id="error-area" class="hidden text-red-500 bg-red-50 p-4 rounded-xl text-sm font-medium">
            Unable to find transaction details. Please check your email.
        </div>

        <div class="mt-12 pt-8 border-t border-gray-100 text-sm text-gray-400">
            <p>A backup activation link has been sent to your email.</p>
            <p class="mt-2">Need help? <a href="https://tally.so/r/obDo51" target="_blank" class="underline hover:text-hermesBlue transition-colors font-medium">Contact Support</a></p>
        </div>
    </div>

    <style>
        @keyframes fadeUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>

    <script>
        const urlParams = new URLSearchParams(window.location.search);
        const sessionId = urlParams.get('session_id');

        if (sessionId) {
            document.getElementById('activation-area').classList.remove('hidden');
            const deepLink = `reso://activate?id=${sessionId}`;
            document.getElementById('activate-btn').href = deepLink;
            document.getElementById('manual-code').textContent = sessionId;

            // ğŸ‰ è§¦å‘ Confetti åº†ç¥ç‰¹æ•ˆ (é«˜çº§ç‰ˆ)
            // å»¶æ—¶ä¸€ç‚¹ç‚¹ï¼Œç­‰ç”¨æˆ·çœ‹æ¸…é¡µé¢å†æ”¾
            setTimeout(() => {
                var duration = 3 * 1000;
                var animationEnd = Date.now() + duration;
                var defaults = { startVelocity: 30, spread: 360, ticks: 60, zIndex: 0 };

                function randomInRange(min, max) {
                  return Math.random() * (max - min) + min;
                }

                var interval = setInterval(function() {
                  var timeLeft = animationEnd - Date.now();

                  if (timeLeft <= 0) {
                    return clearInterval(interval);
                  }

                  var particleCount = 50 * (timeLeft / duration);
                  
                  // ä»å·¦å³ä¸¤è¾¹å‘å°„ï¼Œå½¢æˆæ‹±é—¨åº†ç¥æ•ˆæœ
                  // ä½¿ç”¨çˆ±é©¬ä»•æ©™é¢œè‰² (#F37021) å’Œæ·±è“ (#0B2044) æ··æ­
                  confetti(Object.assign({}, defaults, { 
                      particleCount, 
                      origin: { x: randomInRange(0.1, 0.3), y: Math.random() - 0.2 },
                      colors: ['#F37021', '#0B2044', '#FFD700'] 
                  }));
                  confetti(Object.assign({}, defaults, { 
                      particleCount, 
                      origin: { x: randomInRange(0.7, 0.9), y: Math.random() - 0.2 },
                      colors: ['#F37021', '#0B2044', '#FFD700'] 
                  }));
                }, 250);
            }, 500);

        } else {
            document.getElementById('error-area').classList.remove('hidden');
        }

        function copyCode() {
            const code = document.getElementById('manual-code').textContent;
            navigator.clipboard.writeText(code);
            const btn = event.target;
            const originalText = btn.textContent;
            btn.textContent = 'Copied';
            setTimeout(() => btn.textContent = originalText, 2000);
        }
    </script>
</body>
</html>