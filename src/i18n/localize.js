const SIMPLIFIED_TO_TRADITIONAL_MAP = {
  '万': '萬',
  '与': '與',
  '专': '專',
  '业': '業',
  '个': '個',
  '为': '為',
  '义': '義',
  '么': '麼',
  '习': '習',
  '书': '書',
  '买': '買',
  '乱': '亂',
  '争': '爭',
  '亏': '虧',
  '云': '雲',
  '亚': '亞',
  '产': '產',
  '仅': '僅',
  '从': '從',
  '众': '眾',
  '优': '優',
  '会': '會',
  '传': '傳',
  '价': '價',
  '体': '體',
  '余': '餘',
  '你': '你',
  '侣': '侶',
  '侧': '側',
  '储': '儲',
  '关': '關',
  '兴': '興',
  '内': '內',
  '写': '寫',
  '决': '決',
  '况': '況',
  '冲': '衝',
  '击': '擊',
  '则': '則',
  '刚': '剛',
  '创': '創',
  '删': '刪',
  '别': '別',
  '到': '到',
  '办': '辦',
  '动': '動',
  '务': '務',
  '势': '勢',
  '区': '區',
  '协': '協',
  '单': '單',
  '卖': '賣',
  '历': '歷',
  '压': '壓',
  '发': '發',
  '变': '變',
  '叙': '敘',
  '参': '參',
  '双': '雙',
  '发': '發',
  '台': '臺',
  '叶': '葉',
  '号': '號',
  '后': '後',
  '听': '聽',
  '启': '啟',
  '员': '員',
  '问': '問',
  '图': '圖',
  '围': '圍',
  '国': '國',
  '圆': '圓',
  '场': '場',
  '块': '塊',
  '坚': '堅',
  '处': '處',
  '备': '備',
  '够': '夠',
  '头': '頭',
  '奖': '獎',
  '妈': '媽',
  '实': '實',
  '审': '審',
  '写': '寫',
  '对': '對',
  '导': '導',
  '将': '將',
  '层': '層',
  '归': '歸',
  '录': '錄',
  '当': '當',
  '形': '形',
  '彻': '徹',
  '忆': '憶',
  '总': '總',
  '态': '態',
  '忆': '憶',
  '怀': '懷',
  '态': '態',
  '户': '戶',
  '扩': '擴',
  '护': '護',
  '报': '報',
  '拟': '擬',
  '换': '換',
  '据': '據',
  '揽': '攬',
  '摄': '攝',
  '摆': '擺',
  '数': '數',
  '断': '斷',
  '无': '無',
  '时': '時',
  '显': '顯',
  '暂': '暫',
  '术': '術',
  '杂': '雜',
  '权': '權',
  '条': '條',
  '来': '來',
  '构': '構',
  '样': '樣',
  '标': '標',
  '档': '檔',
  '检': '檢',
  '权': '權',
  '欢': '歡',
  '气': '氣',
  '汇': '匯',
  '汉': '漢',
  '汤': '湯',
  '没': '沒',
  '沟': '溝',
  '测': '測',
  '湾': '灣',
  '满': '滿',
  '滤': '濾',
  '灵': '靈',
  '点': '點',
  '热': '熱',
  '状': '狀',
  '现': '現',
  '环': '環',
  '画': '畫',
  '畅': '暢',
  '界': '界',
  '疗': '療',
  '监': '監',
  '盖': '蓋',
  '盘': '盤',
  '着': '著',
  '码': '碼',
  '础': '礎',
  '确': '確',
  '离': '離',
  '种': '種',
  '积': '積',
  '称': '稱',
  '稳': '穩',
  '笔': '筆',
  '简': '簡',
  '类': '類',
  '粘': '黏',
  '级': '級',
  '线': '線',
  '练': '練',
  '组': '組',
  '结': '結',
  '给': '給',
  '统': '統',
  '网': '網',
  '继': '繼',
  '续': '續',
  '维': '維',
  '绘': '繪',
  '绿': '綠',
  '编': '編',
  '缩': '縮',
  '罚': '罰',
  '置': '置',
  '联': '聯',
  '肤': '膚',
  '脱': '脫',
  '艺': '藝',
  '节': '節',
  '范': '範',
  '类': '類',
  '签': '簽',
  '简': '簡',
  '粮': '糧',
  '纪': '紀',
  '纯': '純',
  '级': '級',
  '纳': '納',
  '纽': '紐',
  '线': '線',
  '组': '組',
  '结': '結',
  '绕': '繞',
  '统': '統',
  '继': '繼',
  '续': '續',
  '罗': '羅',
  '网': '網',
  '翻': '翻',
  '职': '職',
  '联': '聯',
  '聪': '聰',
  '肃': '肅',
  '胁': '脅',
  '脸': '臉',
  '脱': '脫',
  '与': '與',
  '艺': '藝',
  '苏': '蘇',
  '获': '獲',
  '营': '營',
  '装': '裝',
  '观': '觀',
  '览': '覽',
  '触': '觸',
  '订': '訂',
  '认': '認',
  '讲': '講',
  '设': '設',
  '访': '訪',
  '证': '證',
  '试': '試',
  '询': '詢',
  '该': '該',
  '语': '語',
  '说': '說',
  '请': '請',
  '诸': '諸',
  '读': '讀',
  '调': '調',
  '谢': '謝',
  '识': '識',
  '议': '議',
  '译': '譯',
  '详': '詳',
  '谱': '譜',
  '护': '護',
  '贝': '貝',
  '负': '負',
  '贡': '貢',
  '财': '財',
  '责': '責',
  '购': '購',
  '资': '資',
  '赋': '賦',
  '质': '質',
  '赞': '贊',
  '赶': '趕',
  '跃': '躍',
  '轮': '輪',
  '轻': '輕',
  '载': '載',
  '较': '較',
  '边': '邊',
  '达': '達',
  '迁': '遷',
  '还': '還',
  '这': '這',
  '进': '進',
  '远': '遠',
  '连': '連',
  '适': '適',
  '选': '選',
  '递': '遞',
  '遗': '遺',
  '邮': '郵',
  '里': '裡',
  '释': '釋',
  '钟': '鐘',
  '钢': '鋼',
  '钥': '鑰',
  '链': '鏈',
  '销': '銷',
  '错': '錯',
  '键': '鍵',
  '长': '長',
  '门': '門',
  '闭': '閉',
  '阅': '閱',
  '间': '間',
  '队': '隊',
  '阳': '陽',
  '阴': '陰',
  '际': '際',
  '隐': '隱',
  '难': '難',
  '页': '頁',
  '顶': '頂',
  '项': '項',
  '顺': '順',
  '须': '須',
  '顾': '顧',
  '馈': '饋',
  '马': '馬',
  '验': '驗',
  '驱': '驅',
  '高': '高',
  '麦': '麥',
  '黄': '黃',
  '点': '點',
  '齐': '齊',
  '龙': '龍',
  '录': '錄',
  '录': '錄',
};

const traditionalCache = new WeakMap();

const toTraditionalChinese = (input) =>
  input
    .split('')
    .map((char) => SIMPLIFIED_TO_TRADITIONAL_MAP[char] || char)
    .join('');

const deepConvertToTraditional = (value) => {
  if (typeof value === 'string') {
    return toTraditionalChinese(value);
  }

  if (Array.isArray(value)) {
    return value.map((item) => deepConvertToTraditional(item));
  }

  if (value && typeof value === 'object') {
    if (traditionalCache.has(value)) {
      return traditionalCache.get(value);
    }

    const converted = Object.fromEntries(
      Object.entries(value).map(([key, nested]) => [key, deepConvertToTraditional(nested)])
    );
    traditionalCache.set(value, converted);
    return converted;
  }

  return value;
};

export const getLocalizedCopy = (dictionary, language) => {
  if (dictionary[language]) return dictionary[language];
  if (language === 'zh-TW' && dictionary.zh) return deepConvertToTraditional(dictionary.zh);
  return dictionary.en || dictionary.zh || dictionary.ja;
};

